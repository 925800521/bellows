/*! mobify-accordion 0.3.0 2013-07-20 */
var Mobify=window.Mobify=window.Mobify||{};Mobify.$=Mobify.$||window.Zepto||window.jQuery,Mobify.UI=Mobify.UI||{},function(n,t){n.support=n.support||{},n.extend(n.support,{touch:"ontouchend"in t})}(Mobify.$,document),Mobify.UI.Utils=function(n){function t(){if(/iPhone\ OS\ 3_1/.test(navigator.userAgent))return void 0;var n,t=document.createElement("fakeelement"),e={transition:"transitionEnd transitionend",OTransition:"oTransitionEnd",MSTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(n in e)if(void 0!==t.style[n])return e[n]}var e={},o=n.support;return e.events=o.touch?{down:"touchstart",move:"touchmove",up:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup"},e.getCursorPosition=o.touch?function(n){return n=n.originalEvent||n,{x:n.touches[0].clientX,y:n.touches[0].clientY}}:function(n){return{x:n.clientX,y:n.clientY}},e.getProperty=function(n){for(var t=["Webkit","Moz","O","ms",""],e=document.createElement("div").style,o=0;t.length>o;++o)if(void 0!==e[t[o]+n])return t[o]+n},n.extend(e.events,{transitionend:t()}),e}(Mobify.$),Mobify.UI.Accordion=function(n,t){n.support;var e=function(t,e){return this.settings=n.extend({dragRadius:10,closedClass:"m-closed",openedClass:"m-opened",activeClass:"m-active",contentClass:"m-content",innerContentClass:"m-inner-content",headerClass:"m-header",itemClass:"m-item",onTransitionDone:null,onOpened:null,onClosed:null},e||{}),this.$element=n(t),n.extend(this,this.bind()),this};return e.prototype.bind=function(){function e(){var t=n(this).parent();t.hasClass(g)&&n(this).parent().removeClass(C),s(t.hasClass(g)?"closing":"opening"),o()}function o(){var t=0;n("."+x,p).each(function(){var e=n(this);t+=e.height()}),p.css("min-height",t+"px")}function i(n){var e=n.find("."+b),o=e.children(),i="outerHeight"in o?o.outerHeight():o.height();t.events.transitionend&&p.css("min-height",p.height()+i+"px"),e.css("max-height",1.5*i+"px")}function s(n){"opening"===n&&"function"==typeof m.onOpened&&m.onOpened.apply(this,arguments),"closing"===n&&"function"==typeof m.onClosed&&m.onClosed.apply(this,arguments),"function"==typeof m.onTransitionDone&&m.onTransitionDone.apply(this,arguments)}function r(n){n.hasClass(g)&&s("closing"),n.removeClass(y),n.addClass(g),t.events.transitionend||n.removeClass(C),n.find("."+b).css("max-height",0)}function a(n){n.hasClass(y)&&s("opening"),n.addClass(C),n.removeClass(g),n.addClass(y),i(n)}function c(n){h=t.getCursorPosition(n)}function u(n){f=t.getCursorPosition(n)}function d(){if(!(f&&(dx=h.x-f.x,dy=h.y-f.y,f=void 0,dx*dx+dy*dy>v*v))){var t=n(this).parent();t.hasClass(C)?r(t):a(t)}}function l(n){n.preventDefault()}var h,f,p=this.$element,m=this.settings,v=m.dragRadius,y=m.openedClass,g=m.closedClass,C=m.activeClass,b=m.contentClass,M=m.headerClass,x=m.itemClass,w=location.hash,T=p.find("."+M+' a[href="'+w+'"]');T.length?a(T.parent()):p.find("."+y).length&&a(p.find("."+y));var $="."+M;return p.on(t.events.down,$,c).on(t.events.move,$,u).on(t.events.up,$,d).on("click",$,l),t.events.transitionend&&p.on(t.events.transitionend,"."+b,e),{settings:m,open:a,close:r,recalculateItemHeight:i}},e.prototype.unbind=function(){this.$element.off()},e.prototype.destroy=function(){this.unbind(),this.$element.remove()},e}(Mobify.$,Mobify.UI.Utils),function(n){n.fn.accordion=function(t){return this.each(function(){var e=(n(this),this.accordion);e||(e=new Mobify.UI.Accordion(this,t)),this.accordion=e})}}(Mobify.$);