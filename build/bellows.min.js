/*! bellows 0.3.4 2015-01-05 */
var Mobify=window.Mobify=window.Mobify||{},Adaptive=window.Adaptive||{};void 0===Adaptive.$&&(Mobify.$=Mobify.$||window.Zepto||window.jQuery),Mobify.UI=Mobify.UI||{},function(n,e){n.support=n.support||{},n.extend(n.support,{touch:"ontouchend"in e})}(Adaptive.$||Mobify.$,document),Mobify.UI.Utils=function(n){function e(){if(/iPhone\ OS\ 3_1/.test(navigator.userAgent))return void 0;var n,e=document.createElement("fakeelement"),t={OTransition:"oTransitionEnd",MSTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",transition:"transitionEnd transitionend"};for(n in t)if(void 0!==e.style[n])return t[n]}var t={},o=n.support;return t.events=o.touch?{down:"touchstart",move:"touchmove",up:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup"},t.getCursorPosition=o.touch?function(n){return n=n.originalEvent||n,{x:n.touches[0].clientX,y:n.touches[0].clientY}}:function(n){return{x:n.clientX,y:n.clientY}},t.getProperty=function(n){for(var e=["Webkit","Moz","O","ms",""],t=document.createElement("div").style,o=0;e.length>o;++o)if(void 0!==t[e[o]+n])return e[o]+n},n.extend(t.events,{transitionend:e()}),t}(Adaptive.$||Mobify.$),Mobify.UI.Bellows=function(n,e){n.support;var t=function(e,t){return this.settings=n.extend({dragRadius:10,closedClass:"m-closed",openedClass:"m-opened",activeClass:"m-active",contentClass:"m-content",innerContentClass:"m-inner-content",headerClass:"m-header",itemClass:"m-item",moduleClass:"m-bellows",onTransitionDone:null,onOpened:null,onClosed:null},t||{}),this.$element=n(e),n.extend(this,this.bind()),this};return t.prototype.bind=function(){function t(){var e=n(this).parent();e.hasClass(g)&&n(this).parent().removeClass(C),s(e.hasClass(g)?"closing":"opening"),o(p)}function o(e){var t=0;e.children("."+$).each(function(){var e=n(this);t+=e.height()}),e.css("min-height",t+"px")}function i(n){var t=n.children("."+w),s=t.children(),r="outerHeight"in s?s.outerHeight():s.height();t.css("max-height",1.5*r+"px"),e.events.transitionend&&p.css("min-height",p.height()+"px"),setTimeout(function(){$currentBellows=n.closest("."+M),o($currentBellows),$parentBellows=$currentBellows.parent().closest("."+M),$parentBellows.length>0&&i(n.parent().closest("."+$))},150)}function s(n){"opening"===n&&"function"==typeof v.onOpened&&v.onOpened.apply(this,arguments),"closing"===n&&"function"==typeof v.onClosed&&v.onClosed.apply(this,arguments),"function"==typeof v.onTransitionDone&&v.onTransitionDone.apply(this,arguments)}function r(n){n.hasClass(g)&&s("closing"),n.removeClass(y),n.addClass(g),e.events.transitionend||n.removeClass(C),n.children("."+w).css("max-height","0px")}function a(n){n.hasClass(y)&&s("opening"),n.addClass(C),n.removeClass(g),n.addClass(y),i(n)}function l(n){h=e.getCursorPosition(n)}function d(n){f=e.getCursorPosition(n)}function u(){if(!(f&&(dx=h.x-f.x,dy=h.y-f.y,f=void 0,dx*dx+dy*dy>m*m))){var e=n(this).parent();e.hasClass(C)?r(e):a(e)}}function c(n){n.preventDefault()}var h,f,p=this.$element,v=this.settings,m=v.dragRadius,y=v.openedClass,g=v.closedClass,C=v.activeClass,w=v.contentClass,b=v.headerClass,$=v.itemClass,M=v.moduleClass,x=location.hash,T=p.find("."+b+' a[href="'+x+'"]');T.length?a(T.parent()):p.find("."+y).length&&a(p.find("."+y));var A=p.children("."+$).children("."+b);return A.on(e.events.down,l).on(e.events.move,d).on(e.events.up,u).on("click",c),e.events.transitionend&&p.on(e.events.transitionend,"."+w,t),{settings:v,open:a,close:r,recalculateItemHeight:i}},t.prototype.unbind=function(){this.$element.off()},t.prototype.destroy=function(){this.unbind(),this.$element.remove()},t}(Adaptive.$||Mobify.$,Mobify.UI.Utils),function(n){n.fn.bellows=function(e){return this.each(function(){var t=(n(this),this.bellows);t||(t=new Mobify.UI.Bellows(this,e)),this.bellows=t})}}(Adaptive.$||Mobify.$);